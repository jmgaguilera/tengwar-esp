<meta charset="utf-8">
<html>

  <head>
    <!-- TODO: Quitar estos ficheros y descargarlos -->
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

  <!-- Latest compiled JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>  <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="tengespjs.css" media="screen" />
    <script src="gramatica.js"></script>




  </head>

  <body>
    <h1 class="text-center tengwar-it">
      16E2&z1Y6 2$ `V8qEg^j `C 1R5xw#6
    </h1>
    <h3 class="text-center">
      (traductor de español a tengwar)
    </h3>

    <div class="container">

    <div class="panel panel-primary">
      <div class="panel-heading">
        Configuración
      </div>
      <div id="txt_config" class="panel-body">

      </div>


    <a href="#config" data-toggle="collapse">Cambiar configuración</a>
    <div id="config" class="collapse">
      <form id="form_config" class="form-horizontal">
        <label class="radio-inline"><input name="input-annatar" type="radio" value="">fuente annatar</label>
        <label class="radio-inline"><input name="input-annatar" type="radio" value="">fuente annatar itálica</label>
        <br/>
        <label class="radio-inline"><input name="input-vocales" type="radio" value="">vocales tehtar</label>
        <label class="radio-inline"><input name="input-vocales" type="radio" value="">vocales plenas</label>
        <br/>
        <label class="checkbox-inline"><input name="input-grupos" type="checkbox" value="">abreviar nasal+oclusiva (nt, mp, nch, nk, nd, mb, ng)</label>

        <br/>
      </form>
    </div>
    </div>
    </div>

    <div class="container">
    <div class="panel panel-primary">
      <div class="panel-heading">
        Entrada de texto en español
      </div>
      <div id="entrada_texto" class="panel-body">
        <form id="form_entrada" class="form-horizontal">
        <div class="form-group">
          <label class="control-label col-sm-2" for="txt_entrada">Español:</label>
          <div class="col-sm-10">
          <input type="text" class="form-control" id="txt_entrada" />
          </div>
        </div>
        </form>
      </div>
    </div>

    <div class="panel panel-primary">
      <div class="panel-heading">
        Resultado en tengwar:
      </div>
      <div id="traduccion" class="panel-body text-center h1">

      </div>
    </div>
    <div class="panel panel-primary">
      <div class="panel-heading">
        Resultado en tengwarscript (paquete LaTeX):
      </div>
      <div id="traduccion_latex" class="panel-body">

      </div>
    </div>
    </div>


    <script type="text/javascript">
      'use scrict';

      var configuracion = {
        vocales: "tehtar",
        fuente: "Tengwar Annatar",
        abreviar_nasal_oclusiva: 'No',
      };

      var clase_traduccion = "panel-body text-center h1";

        document.getElementById('form_entrada').onsubmit = function() {
            return false;
        };


       function calcular() {
            var texto = this.value;
            var analizador = new AnalizadorSintactico(texto, configuracion);
             try {
               analizador.analizar(configuracion.fuente==="Tengwar Annatar" ? "tengwar-alt" : "tengwar-alt-it");
               traduccion.innerHTML = analizador.getAnnatar();
               traduccion_latex.innerHTML = analizador.getTengwarscript();
             } catch (e) {
               traduccion.innerHTML = e.toString();
               traduccion_latex.innerHTML = "";
             }

        }

        var txt_entrada = document.getElementById("txt_entrada");
        txt_entrada.onkeyup= calcular;

        function describir_configuracion() {
          var txt_config = document.getElementById("txt_config");
          var nuevo_txt = "";
          for (i in configuracion) {
            nuevo_txt += "<b>"+i+"</b>: "+configuracion[i]+"; ";
          }
          txt_config.innerHTML = nuevo_txt;
        }

        function iniciar_configuracion() {

          var chk_grupo = document.getElementsByName("input-grupos")[0];

          configuracion.abreviar_nasal_oclusiva = (chk_grupo.checked ? "Si" : "No");
          chk_grupo.onchange = function() {
            configuracion.abreviar_nasal_oclusiva = (chk_grupo.checked ? "Si" : "No");
            calcular.call(txt_entrada);
            describir_configuracion();
          }


          var radio = document.getElementsByName("input-vocales");

          for (i=0; i<radio.length; i++) {
            (function(indice) {
              radio[i].onclick = function() {
                if (indice === 0) {
                  configuracion.vocales = "tehtar";
                } else {
                  configuracion.vocales = "plenas";
                }
                calcular.call(txt_entrada);
                describir_configuracion();
              }
            }(i));
          }

          if (configuracion.vocales === "tehtar") {
            configuracion.vocales = "tehtar";
            radio[0].checked = true;
          } else {
            configuracion.vocales = "plenas";
            radio[1].checked = true;
          }


          radio = document.getElementsByName("input-annatar");

          for (i=0; i<radio.length; i++) {
            (function(indice) {
              radio[i].onclick = function() {
                if (indice === 0) {
                  configuracion.fuente = "Tengwar Annatar";
                } else {
                  configuracion.fuente = "Tengwar Annatar Italic";
                }
                if (configuracion.fuente === "Tengwar Annatar") {
                  document.getElementById("traduccion").className = clase_traduccion + " tengwar";
                }else{
                  document.getElementById("traduccion").className = clase_traduccion + " tengwar-it";
                }
                describir_configuracion();
              }
            }(i));
          }

          if (configuracion.fuente === "Tengwar Annatar") {
            document.getElementById("traduccion").className = clase_traduccion + " tengwar";
            radio[0].checked = true;
          }else{
            document.getElementById("traduccion").className = clase_traduccion + " tengwar-it";
            radio[1].checked = true;
          }

        }

        window.onload = function() {
          iniciar_configuracion();
          describir_configuracion();
        }

</script>



  </body>
</html>
